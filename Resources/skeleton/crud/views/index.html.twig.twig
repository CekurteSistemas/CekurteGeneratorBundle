{% block extends %}
{{ "{% extends 'CekurteGeneratorBundle::layout.html.twig' %}" }}
{% endblock extends %}

{% block body %}
{{ "{% set title    = '" ~ entity ~ "'|trans %}" }}
{{ "{% set subtitle = '" ~ 'List' ~ "'|trans %}" }}

{{ "{% block search -%}" }}
    {{ "{% include '" ~ bundle ~ ":" ~ entity ~ ":search.html.twig' %}" }}
{{ "{% endblock %}" }}

{{ "{% block links -%}" }}
    {{ "{% embed 'CekurteGeneratorBundle:Action:search.html.twig' only %}
    {% endembed %}" }}
    {{ "{% embed 'CekurteGeneratorBundle:Action:create.html.twig' with {
        'route': '" ~ route_name_prefix ~ "_new'
    } only %}
    {% endembed %}" }}
    {{ "{% embed 'CekurteGeneratorBundle:Action:export.html.twig' with {
        'route': '" ~ route_name_prefix ~ "_export'
    } only %}
    {% endembed %}" }}
{{ "{% endblock %}" }}

{{ "{% block links_footer -%}" }}
    {{ "{{ knp_pagination_render(pagination) }}" }}
{{ "{% endblock %}" }}

{{ "{% block content -%}" }}
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                {%- for field, metadata in fields %}

                    <th{{ "{% if pagination.isSorted('ck." ~ field ~ "') %}" }} class="sorted"{{ "{% endif %}" }}>{{ "{{ knp_pagination_sortable(pagination, '" ~ field|capitalize ~ "'|trans, 'ck." ~ field ~ "', {'title' : 'Order by'|trans" ~ " ~ ' ' ~ '" ~ field|capitalize ~ "'|trans}) }}" }}</th>

                {%- endfor %}

                    {{ "{% if cekurte_is_granted('RETRIEVE') or cekurte_is_granted('UPDATE') or cekurte_is_granted('DELETE') %}" }}
                        <th class="action">{{ "{{ 'Actions'|trans }}" }}</th>
                    {{ "{% endif %}" }}
                </tr>
            </thead>
            <tbody>
            {{ '{% for entity in pagination %}' }}
                <tr>

            {%- for field, metadata in fields %}
                {%- if loop.first and ('show' in actions) %}

                    <td><a href="{{ "{{ path('" ~ route_name_prefix ~ "_show', { 'id': entity.id }) }}" }}">{{ '{{ entity.' ~ field|replace({'_': ''}) ~ ' }}' }}</a></td>

                {%- elseif field in ['picture', 'image', 'thumb', 'thumbnail', 'file', 'filename'] %}

                    <td>
                        {{ "{%- if entity." ~ field|replace({'_': ''}) ~ " != '' -%}" }}
                            <img class="img-thumbnail" src="{{ "{{ entity." ~ field|replace({'_': ''}) ~ "|imagine_filter('admin_thumbnail_list') }}" }}">
                        {{ "{%- endif -%}" }}
                    </td>

                {%- elseif metadata.type in ['date'] %}

                    <td>{{ '{{ entity.' ~ field|replace({'_': ''}) ~ '|localizeddate(\'medium\', \'none\') }}' }}</td>

                {%- elseif metadata.type in ['time'] %}

                    <td>{{ '{{ entity.' ~ field|replace({'_': ''}) ~ '|localizeddate(\'none\', \'medium\') }}' }}</td>

                {%- elseif metadata.type in ['datetime', 'datetimetz'] %}

                    <td>{{ '{{ entity.' ~ field|replace({'_': ''}) ~ '|localizeddate(\'medium\', \'medium\') }}' }}</td>

                {%- elseif metadata.type in ['text'] %}

                    <td>{{ '{{ entity.' ~ field|replace({'_': ''}) ~ '|striptags|truncate(50) }}' }}</td>

                {%- elseif metadata.type in ['boolean'] %}

                    <td>{{ '{{ entity.' ~ field|replace({'_': ''}) ~ ' == true ? ' ~ "'Yes'|trans" ~ ' : ' ~  "'No'|trans" ~' }}' }}</td>

                {%- else %}

                    <td>{{ '{{ entity.' ~ field|replace({'_': ''}) ~ ' }}' }}</td>

                {%- endif %}

                {%- if loop.last %}

                    {{ "{% if cekurte_is_granted('RETRIEVE') or cekurte_is_granted('UPDATE') or cekurte_is_granted('DELETE') %}" }}
                        <td>
                            {{ "{% embed 'CekurteGeneratorBundle:Action:retrieve.html.twig' with {
                                'route'             : '" ~ route_name_prefix ~ "_show',
                                'identifierKey'     : 'id',
                                'identifierValue'   : entity.id
                            } only %}
                            {% endembed  %}" }}
                            {{ "{% embed 'CekurteGeneratorBundle:Action:update.html.twig' with {
                                'route' : '" ~ route_name_prefix ~ "_edit',
                                'identifierKey'     : 'id',
                                'identifierValue'   : entity.id
                            } only %}
                            {% endembed  %}" }}
                            {{ "{% embed 'CekurteGeneratorBundle:Action:delete.html.twig' with {
                                'route'             : '" ~ route_name_prefix ~ "_delete',
                                'identifierKey'     : 'id',
                                'identifierValue'   : entity.id,
                                'form'              : delete_form,
                            } only %}
                            {% endembed  %}" }}
                        </td>
                    {{ "{% endif %}" }}

                {%- endif %}
            {%- endfor %}

                </tr>
            {{ '{% endfor %}' }}
            </tbody>
        </table>
    </div>
{{ "{% endblock %}" }}

{%- set hasDateField = false -%}

{%- for field in fields -%}
    {%- if field.type in ['date'] -%}
        {%- set hasDateField = true -%}
    {%- endif -%}
{%- endfor %}

{%- if hasDateField == true -%}
{{ "\n" }}
{{ "{%- block stylesheets -%}" }}
    {{ "{{ parent() }}" }}

    {{ "{%- include 'CekurteGeneratorBundle:DatePicker:style.html.twig' -%}" }}
{{ "{%- endblock -%}" }}
{%- endif -%}

{%- if hasDateField == true -%}
{{ "\n" }}
{{ "{%- block javascripts -%}" }}
    {{ "{{ parent() }}" }}

    {%- if hasDateField == true -%}
    {{ "\n" }}
    {{ "{%- include 'CekurteGeneratorBundle:DatePicker:script.html.twig' -%}" }}
    {%- endif -%}
{{ "\n" ~ "{%- endblock -%}" }}

{%- endif -%}
{{ "\n" }}
{%- endblock body %}