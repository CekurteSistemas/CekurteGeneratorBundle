
    /**
{% block phpdoc_method_header %}
     * Export {{ entity }} entities to Excel.
{% endblock phpdoc_method_header %}
     *
{% block phpdoc_method_annotations %}
{% if 'annotation' == format %}
     * @Route("/export/sort/{sort}/direction/{direction}/", defaults={"sort"="ck.id", "direction"="asc"}, name="{{ route_name_prefix }}_export")
     * @Method("GET")
     * @Template()
     * @Secure(roles="ROLE_{{ bundle | upper }}_{{ entity | upper }}, ROLE_ADMIN")
{% endif %}
{% endblock phpdoc_method_annotations %}
     *
     * @param string $sort
     * @param string $direction
     * @return StreamedResponse
{% include 'crud/actions/author.php.twig' %}
     */
{% block method_definition %}
    public function exportAction()
{% endblock method_definition %}
    {
{% block method_body %}
        $form = $this->createForm(new {{ entity }}FormType(), new {{ entity }}(), array(
            'search' => true,
        ));

        if ($this->getSession()->has('search_{{ entity | lower }}')) {

            $form->bind($this->getSession()->get('search_{{ entity | lower }}'));
        }

        $query = $this->getEntityRepository()->getQuery($form->getData(), $sort, $direction);

        $office = new CekurtePHPExcel('RelatÃ³rio de {{ entity }}s');

        $office
            ->setHeader(array(
            {% for field in fields %}
    '{{ field.fieldName }}' => '{{ field.fieldName }}',
            {% endfor -%}
        ))
            ->setData($query->getArrayResult())
            ->build()
        ;
{% endblock method_body %}

{% block method_return %}
        return $office->createResponse();
{% endblock method_return %}
    }
