<?php

namespace {{ namespace }}\Form{{ entity_namespace ? '\\' ~ entity_namespace : '' }}\Type;

{% block use_statements %}
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;
{% endblock use_statements %}

/**
 * {{ entity_class }} type.
 *
 * @author JoÃ£o Paulo Cercal <sistemas@cekurte.com>
 * @version 0.1
 */
{% block class_definition %}
class {{ form_class }} extends AbstractType
{% endblock class_definition %}
{
{% block class_body %}
    /**
     * {@inheritdoc}
{% include 'crud/actions/author.php.twig' %}
     */
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        if ($options['search'] === true) {
            {% for field in fields %}

            $builder->add('{{ field.fieldName }}')->setRequired(false);

            {%- endfor %}


        } else {

            $builder
            {%- for field in fields %}

                {% if field.type == 'text' -%}
                ->add('{{ field.fieldName }}', 'textarea', array(
                    'attr'  => array(
                        'class' => 'ckeditor'
                    )
                ))
                {%- elseif field.fieldName in ['picture', 'image', 'thumb', 'thumbnail', 'file', 'filename'] -%}
                ->add('{{ field.fieldName }}', 'hidden', array(
                    'attr'  => array(
                        'class' => '{{ entity_class|lower }}_{{ field.fieldName }}'
                    )
                ))
                {%- else -%}
                ->add('{{ field.fieldName }}')
                {%- endif %}

            {%- endfor %}

            ;
        }
    }

    /**
     * {@inheritdoc}
{% include 'crud/actions/author.php.twig' %}
     */
    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'search'     => false,
            'data_class' => '{{ namespace }}\Entity{{ entity_namespace ? '\\' ~ entity_namespace : '' }}\{{ entity_class }}'
        ));
    }

    /**
     * {@inheritdoc}
{% include 'crud/actions/author.php.twig' %}
     */
    public function getName()
    {
        return '{{ form_type_name }}';
    }
{% endblock class_body %}
}
